const express= require('express');
const router = express.Router();

const CVE = require('../models/cve.model');

router.get('/:regex',async(req,res)=>{
    const regexString = req.params.regex;
    const regexPattern = new RegExp(`CVE-${regexString}`, 'i');
    const data = await CVE.find({ id: { $regex: regexPattern } });
    // console.log(data.length);
    res.json(data);
});

module.exports = router;